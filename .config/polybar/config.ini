include-file = ~/.themes/default/polybar.theme

[settings]
screenchange-reload = true

[global/wm]
margin-bottom = 0

[bar/main]
monitor-strict = false
tray-position = none
override-redirect = true
wm-restack = bspwm
width = ${env:BAR_WIDTH}
height = 25
offset-x = 10
offset-y = 10

background = ${color.bg}
foreground = ${color.fg}

font-0 = "JetBrains Mono:pixelsize=11:weight=medium;2"
separator = " "

border-size = 2
border-color = ${color.black-alt}
fixed-center = true

modules-left = offset desktop offset user at domain arrow project colon region offset offset artist offset track
modules-center = location datelocal dash timelocal timezulu
modules-right = weathertemperature weathercondition offset volume root cpu memory offset layout screenshare offset

[module/desktop]
type = internal/bspwm
label-empty =
label-empty-padding = 0
label-occupied =
label-occupied-padding = 0
label-urgent =
label-urgent-padding = 0

[module/user]
type = custom/script
format-foreground = ${color.yellow}
exec = "cat $HOME/.config/gcloud/configurations/config_default 2>/dev/null | grep -Po '^account = \\K(\\w+)'"
interval = 10

[module/at]
type = custom/text
content = "@"

[module/domain]
type = custom/script
format-foreground = ${color.green}
exec = "cat $HOME/.config/gcloud/configurations/config_default 2>/dev/null | grep -Po '^account = \\w+@\\K(.+)$'"
interval = 10

[module/arrow]
type = custom/text
content = "→"

[module/project]
type = custom/script
format-foreground = ${color.red}
exec = "cat $HOME/.config/gcloud/configurations/config_default 2>/dev/null | grep -Po '^project = \\K(.*)$'"
interval = 10

[module/colon]
type = custom/text
content = ":"

[module/region]
type = custom/script
format-foreground = ${color.blue}
exec = "cat $HOME/.config/gcloud/configurations/config_default 2>/dev/null | grep -Po '^region = \\K(.*)$'"
interval = 10

[module/dash]
type = custom/text
content-foreground = ${color.black-alt}
content = "-"

[module/artist]
type = custom/script
format-foreground = ${color.black-alt}
exec = "baton status | grep -Po '^Artist: \\K(.*)$'"
exec-if = "[[ $BAR_WIDTH -gt 2000 ]] && baton status | grep -Po '^State: Playing$'"
click-left = "baton pause"
double-click-left = "baton next"
interval = 10

[module/track]
type = custom/script
format-foreground = ${color.fg}
exec = "baton status | grep -Po '^Track: \\K(.*)$'"
exec-if = "[[ $BAR_WIDTH -gt 2000 ]] && baton status | grep -Po '^State: Playing$'"
click-left = "baton pause"
double-click-left = "baton next"
interval = 10

[module/datelocal]
type = custom/script
exec = TZ=America/Los_Angeles date +"%y-%m-%d"
interval = 600

[module/timelocal]
type = custom/script
exec = TZ=America/Los_Angeles date +"%H:%M"
interval = 10

[module/timezulu]
type = custom/script
format = <label>
format-foreground = ${color.black-alt}
exec = TZ=UTC date +"%H:%M"
interval = 10

[module/location]
type = custom/script
exec = "curl -s https://ipinfo.io/$(curl -s https://ipinfo.io/ip) | jq -r '.country'"
format-foreground = ${color.black-alt}
click-left = "goto -u maps.google.com"
interval = 3600 

[module/weathercondition]
type = custom/script
exec = "curl -s wttr.in/Los_Angeles?format='+%C' | tr '[:upper:]' '[:lower:]'"
exec-if = "[[ $BAR_WIDTH -gt 2000 ]] && echo 0"
click-left = "goto -u google.com/search?q=weather"
format-foreground = ${color.black-alt}
interval = 600

[module/weathertemperature]
type = custom/script
exec = "curl -s wttr.in/Los_Angeles?format='+%t'"
click-left = "goto -u google.com/search?q=weather"
interval = 600

[module/volume]
type = internal/pulseaudio
interval = 5
format-volume = <label-volume> <bar-volume>
label-volume = V
bar-volume-indicator =
bar-volume-width = 10
bar-volume-foreground-0 = ${color.yellow}
bar-volume-fill = /
bar-volume-empty = /
bar-volume-empty-foreground = ${color.black-alt}

[module/root]
type = internal/fs
mount-0 = /
interval = 5
warn-percentage = 90
format-mounted = <label-mounted> <bar-used>
label-mounted = R
format-unmounted = 
label-unmounted = 
bar-used-indicator =
bar-used-width = 10
bar-used-foreground-0 = ${color.green}
bar-used-fill = /
bar-used-empty = /
bar-used-empty-foreground = ${color.black-alt}

[module/cpu]
type = internal/cpu
interval = 5
format = <label> <bar-load>
label = C
warn-percentage = 95
bar-load-indicator =
bar-load-width = 10
bar-load-foreground-0 = ${color.red}
bar-load-fill = /
bar-load-empty = /
bar-load-empty-foreground = ${color.black-alt}

[module/memory]
type = internal/memory
interval = 5
warn-percentage = 90
format = <label> <bar-used>
label = M
bar-used-indicator =
bar-used-width = 10
bar-used-foreground-0 = ${color.blue}
bar-used-fill = /
bar-used-empty = /
bar-used-empty-foreground = ${color.black-alt}

[module/window]
type = internal/xwindow
format-foreground = ${color.cyan}

[module/layout]
type = internal/xkeyboard
format = <label-layout> <label-indicator>
label-layout = %layout%
label-indicator-on = %name%
label-layout-foreground = ${color.fg}
label-indicator-on-capslock-foreground = ${color.black-alt}
label-indicator-on-capslock = "caps"
label-indicator-off-capslock =
label-indicator-on-numlock = "num"
label-indicator-on-numlock-foreground = ${color.black-alt}
label-indicator-off-numlock =
label-indicator-on-scrolllock = "scr"
label-indicator-on-scrolllock-foreground = ${color.black-alt}
label-indicator-off-scrolllock =

[module/screenshare]
type = custom/script
format-foreground = ${color.red}
exec = "xwininfo -name 'meet.google.com is sharing your screen.' > /dev/null 2>&1 && echo ' ↑'"
interval = 3

[module/offset]
type = custom/text
content = " "

