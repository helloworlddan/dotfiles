#!/bin/sh

# Set keyboard layout
setxkbmap us

# Configure X cursor
xsetroot -cursor_name left_ptr

# Autohide cursor when idle
xbanish &

# Configure key repeat delay
xset r rate 220

# Load .Xresources for terminal theme and X11 apps
xrdb -load ~/.Xresources

#  Virtual desktop layout
#
#  |-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|--------|
#  |  1 b  |  2 v  |  3 d  |  4 g  |  5 a  |  6 w  |  7 m  |  8 c  |  9 n  |  0 z  |  p     |
#  |-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|--------|
#  |  bsh |  vim | 󱔗 doc |  gcp |  add |  web | 󰺻 com | 󰃰 cal |  not |  gvc |  pers |
#  |-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|--------|

# Configure primary screen
if [ $(hostname) == "battlestation" ] || [ $(hostname) == "top" ]; then
  xrandr --output DUMMY0 --primary
  bspc monitor DUMMY0 -n main
  bspc monitor main -s '^1'
elif [ $(hostname) == "box" ]; then
  xrandr --output HDMI-1 --primary
  bspc monitor HDMI-1 -n main
  bspc monitor main -s '^1'
elif [ $(hostname) == "stamer" ]; then
  xrandr --output eDP-1 --primary
  bspc monitor eDP-1 -n main
  bspc monitor main -s '^1'
else
  echo "on default"
fi

# Configure workspace names
bspc monitor main -d "" "" "󱔗" "" "" "" "󰺻" "󰃰" "" "" ""

# Configure behavior and look
bspc config border_width 2
bspc config top_padding 0
bspc config window_gap 5
bspc config split_ratio 0.5
bspc config borderless_monocle false
bspc config gapless_monocle false
bspc config focus_follows_pointer true
bspc config automatic_scheme longest_side
bspc config pointer_modifier mod1
bspc config pointer_action1 move
bspc config pointer_action2 resize_corner

# Reset rules
bspc rule -r '*'

# Mnemonic rules
bspc rule -a *:console.cloud.google.com monitor=main desktop=""
bspc rule -a *:pkg.go.dev monitor=main desktop="󱔗"
bspc rule -a *:console.cloud.google.com monitor=main desktop=""
bspc rule -a *:app.slack.com__client monitor=main desktop=""
bspc rule -a *:gimp monitor=main desktop=""
bspc rule -a *:excalidraw.com monitor=main desktop=""
bspc rule -a *:mail.google.com monitor=main desktop="󰺻"
bspc rule -a *:calendar.google.com monitor=main desktop="󰃰"
bspc rule -a *:keep.google.com monitor=main desktop=""
bspc rule -a *:go__stamer_notes monitor=main desktop=""
bspc rule -a *:meet.google.com monitor=main desktop=""

# Rules for Chrome's "XXX is sharing your screen" windows.
bspc rule -a *:*:"meet.google.com is sharing your screen." hidden=on
bspc rule -a *:*:"teams.microsoft.com is sharing your screen." hidden=on
bspc rule -a *:*:"zoom.us is sharing your screen." hidden=on

# Launch hotkey daemon
sxhkd &

# Load theme
sh "${HOME}/.themes/default/bspwm.theme"
